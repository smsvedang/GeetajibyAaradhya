<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Course | Gitadhya</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="style.css">

    <style>
        .course-container {
            max-width: 1100px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .shloka-card {
            background: #fff;
            border-left: 5px solid #ff9800;
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
        }

        .shloka-card iframe {
            width: 100%;
            height: 315px;
            margin-top: 15px;
            border-radius: 8px;
        }

        .complete-btn {
            margin-top: 15px;
            background: #4caf50;
            color: #fff;
            padding: 10px 18px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        .complete-btn:disabled {
            background: #aaa;
            cursor: not-allowed;
        }
    </style>
</head>

<body>

    <div class="auth-overlay" id="auth-overlay">
        <div class="auth-modal" id="login-modal">
            <button class="auth-close" onclick="closeAuth()" aria-label="Close">✕</button>
            <h2>Haree Krishna,</h2>
            <form id="student-login-form">
                <input type="tel" id="l-mobile" placeholder="Mobile Number" required>
                <input type="password" id="l-pass" placeholder="Password" required>
                <button type="submit" class="auth-btn">Login to Continue</button>
            </form>
            <div class="auth-switch" onclick="switchAuth('register')">New seeker? Register here</div>
        </div>

        <div class="auth-modal" id="register-modal" style="display:none;">
            <button class="auth-close" onclick="closeAuth()" aria-label="Close">✕</button>
            <h2>Join the Journey,</h2>
            <form id="student-register-form">
                <input type="text" id="r-name" placeholder="Your Full Name" required>
                <div style="font-size:0.85rem; color:var(--text-muted); margin:-4px 0 10px;">
                    Phone number वही डालें जिस पर आप certificate receive करेंगे
                </div>
                <input type="tel" id="r-mobile" placeholder="Mobile Number" required>
                <input type="password" id="r-pass" placeholder="Create Password" required>
                <button type="submit" class="auth-btn">Register</button>
            </form>
            <div class="auth-switch" onclick="switchAuth('login')">Already registered? Login here</div>
        </div>
    </div>

    <h1 style="text-align:center;margin-top:25px;" id="course-title">
        Loading course...
    </h1>

    <div class="course-container" id="course-container"></div>

    <script src="course.js"></script>
    <footer class="main-footer">
        <div class="container">
            <div class="footer-grid">
                <div>
                    <div class="footer-badge"><i class="fas fa-seedling"></i> Gitadhya</div>
                    <h2 id="footer-logo-text">Gita by Aaradhya</h2>
                    <p>Rooted in the Bhagavad Gita, guided by devotion, and shared with love for every seeker.</p>
                    <div class="social-row" id="social-links"></div>
                </div>
                <div class="footer-links">
                    <h3>Explore</h3>
                    <a href="index.html"><i class="fas fa-home"></i> Home</a>
                    <a href="courses.html"><i class="fas fa-graduation-cap"></i> Courses</a>
                    <a href="artwork.html"><i class="fas fa-palette"></i> Art</a>
                    <a href="blog.html"><i class="fas fa-pen-nib"></i> Blog</a>
                    <a href="testimonials.html"><i class="fas fa-heart"></i> Testimonials</a>
                </div>
                <div class="footer-contact">
                    <h3>Contact</h3>
                    <a href="tel:+919243714402"><i class="fas fa-phone"></i> +91 9243714402</a>
                    <a href="mailto:warrioraaradhya111@gmail.com"><i class="fas fa-envelope"></i> warrioraaradhya111@gmail.com</a>
                </div>
            </div>
            <div class="footer-bottom">
                <span>&copy; 2026 Gitadhya | Gita by Aaradhya</span>
                <span>Guided by devotion, shared with love.</span>
            </div>
        </div>
    </footer>
    <script>
        let currentUser = null;
        try {
            currentUser = JSON.parse(localStorage.getItem('gitadhya_user'));
        } catch (e) {
            localStorage.removeItem('gitadhya_user');
        }

        function showAuth() { document.getElementById('auth-overlay').style.display = 'flex'; }
        function closeAuth() { document.getElementById('auth-overlay').style.display = 'none'; }
        function switchAuth(type) {
            document.getElementById('login-modal').style.display = type === 'login' ? 'block' : 'none';
            document.getElementById('register-modal').style.display = type === 'register' ? 'block' : 'none';
        }

        const isLoggedIn = !!(currentUser && currentUser.mobile);
        if (!isLoggedIn) {
            window.addEventListener('load', () => {
                showAuth();
            });
        } else {
            closeAuth();
        }

        if (isLoggedIn && currentUser.mobile && !localStorage.getItem('user_mobile')) {
            localStorage.setItem('user_mobile', currentUser.mobile);
        }

        document.getElementById('student-register-form').onsubmit = async (e) => {
            e.preventDefault();
            const res = await fetch('/api/student/register', {
                method: 'POST', headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name: document.getElementById('r-name').value, mobile: document.getElementById('r-mobile').value, password: document.getElementById('r-pass').value })
            });
            const d = await res.json();
            if (d.success) { localStorage.setItem('gitadhya_user', JSON.stringify(d.student)); localStorage.setItem('user_mobile', d.student.mobile); location.reload(); }
            else alert(d.message);
        };

        document.getElementById('student-login-form').onsubmit = async (e) => {
            e.preventDefault();
            const res = await fetch('/api/student/login', {
                method: 'POST', headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ mobile: document.getElementById('l-mobile').value, password: document.getElementById('l-pass').value })
            });
            const d = await res.json();
            if (d.success) { localStorage.setItem('gitadhya_user', JSON.stringify(d.student)); localStorage.setItem('user_mobile', d.student.mobile); location.reload(); }
            else alert(d.message);
        };

        // Load site info for social links
        (async () => {
            try {
                const sr = await fetch('/api/settings');
                const settings = await sr.json();
                const socBox = document.getElementById('social-links');
                if (socBox) {
                    socBox.innerHTML = '';
                    const icons = { instagram: 'fab fa-instagram', youtube: 'fab fa-youtube', twitter: 'fab fa-twitter', facebook: 'fab fa-facebook' };
                    if (settings.personalLink) {
                        socBox.innerHTML += `<a href="${settings.personalLink}" target="_blank" class="social-icon"><i class="fas fa-globe"></i></a>`;
                    }
                    if (settings.social) {
                        Object.keys(settings.social).forEach(key => {
                            const url = settings.social[key];
                            if (url) socBox.innerHTML += `<a href="${url}" target="_blank" class="social-icon"><i class="${icons[key]}"></i></a>`;
                        });
                    }
                }
            } catch (e) { console.error("Settings load error", e); }
        })();
    </script>
    <script src="pwa.js"></script>
</body>

</html>
