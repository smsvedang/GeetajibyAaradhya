<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-H5L4Y0WRMW"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-H5L4Y0WRMW');
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Aaradhya Soni | Inspiring Gita Shlokas & Artwork Gallery</title>
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="manifest" href="/site.webmanifest">
    <meta name="description" content="Listen to Aaradhya Soni, an inspiring SMA Type 2 warrior, recite Bhagavad Gita shlokas. Explore her journey and view her beautiful artwork gallery.">
    <meta name="keywords" content="Aaradhya Soni, Gita Shlokas, Bhagavad Gita, SMA Type 2, LearnGeeta, Artwork Gallery, Gita Recitation">
    <script type="application/ld+json">
    {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Aaradhya Soni - The SMA Warrior",
    "alternateName": "Warrior Aaradhya",
    "url": "https://warrioraaradhya.in"
    }
    </script>
    <link rel="stylesheet" href="style.css">

    <!-- [STEP 1] SWIPER SLIDER KI CSS FILE -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    
    <!-- [STEP 2] NAYE TESTIMONIAL SLIDER KA STYLE -->
    <style>
        .testimonialSwiper {
          width: 100%;
          max-width: 800px; 
          margin: 0 auto;
          height: 500px; /* Thodi height badha di */
          padding-bottom: 50px; 
        }

        .testimonialSwiper .swiper-slide {
          background: none;
          display: flex;
          justify-content: center;
          align-items: center;
          padding: 10px;
        }

        .testimonial-card-new {
          background: #ffffff;
          border-radius: 12px;
          border: 1px solid #e0e0e0;
          box-shadow: 0 5px 15px rgba(0, 0, 0, 0.07);
          padding: 30px;
          padding-top: 40px;
          height: 500px; /* Card ki height */
          width: 100%;
          display: flex;
          flex-direction: column;
          justify-content: center; /* Vertically center */
          position: relative;
          text-align: center;
          box-sizing: border-box;
        }

        .testimonial-card-new .quote-icon {
          position: absolute;
          top: -10px;
          left: 50%;
          transform: translateX(-50%);
          font-size: 80px;
          color: #D84315; /* Aapke logo ka color */
          line-height: 1;
          opacity: 0.15;
          font-family: Georgia, serif;
        }

        .testimonial-card-new .quote-text {
          font-size: 1.1rem;
          font-style: italic;
          color: #333;
          line-height: 1.6;
          margin: 0;
          z-index: 2;
          flex-grow: 1; 
          display: flex;
          align-items: flex-start;  /* <<-- YEH HAI PROBLEM */
          justify-content: center;
          overflow-y: auto; 
          padding-right: 5px;
        }

        .testimonial-card-new .author-details {
          margin-top: 20px;
          z-index: 2;
          flex-shrink: 0;
        }

        .testimonial-card-new .author-name {
          font-weight: 700;
          font-size: 1rem;
          color: #D84315; /* Logo color */
          display: block;
        }

        /* Swiper Arrows & Dots */
        .testimonialSwiper .swiper-button-next,
        .testimonialSwiper .swiper-button-prev {
          color: #D84315;
        }
        .testimonialSwiper .swiper-pagination-bullet-active {
          background: #D84315;
        }
    </style>

</head>
<body>
    
    <nav class="top-navbar">
        <div class="container nav-container">
            <div class="logo">
                <a href="index.html" style="text-decoration: none; color: #D84315;">Warrior Aaradhya</a>
            </div>
            
            <button class="menu-toggle" id="menu-toggle-button">
                <span></span>
                <span></span>
                <span></span>
            </button>
            
            <div class="menu-links" id="menu-links-container">
                <button class="main-tab-button active" data-tab="tab-shlokas">Home (Shlokas)</button>
                <button class="main-tab-button" data-tab="tab-about">About Aaradhya</button>
                <button class="main-tab-button" data-tab="tab-gallery">Artwork Gallery</button>
                <button class="main-tab-button" data-tab="tab-blog">Blog</button>
                <a href="testimonials.html" class="main-tab-button">Testimonials</a>
                <a href="japcounter.html" class="main-tab-button">Jap Counter</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="main-tab-panels">

            <div id="tab-shlokas" class="main-tab-content active">
                
                <header class="shloka-welcome-hero">
                    <h1>Shrimad Bhagavad Gita</h1>
                    <p class="subtitle">Shloka Recitation by Aaradhya Soni</p>
                </header>
                
                <main class="shloka-list-container">
                    <div id="shloka-container">
                        <p>Loading shlokas...</p>
                    </div>
                </main>
            </div>

            <div id="tab-about" class="main-tab-content">
                <section class="about">
                    <h2>About Aaradhya</h2>
                    <div class="about-content">
                        <div class="about-image">
                            <img src="https://placehold.co/400x400/FFF8E1/BFA080?text=Aaradhya" alt="Aaradhya Soni" id="about-image-src">
                        </div>
                        <div class="about-text" id="about-text-content">
                            <p>Loading details...</p> 
                        </div>
                    </div>
                </section>
            </div>

            <div id="tab-gallery" class="main-tab-content">
                <section class="gallery">
                    <h2>Aaradhya's Artwork Gallery</h2>
                    <div class="carousel-container" id="gallery-carousel-container">
                        <p>Loading gallery...</p>
                    </div>
                </section>
            </div>
            
            <div id="tab-blog" class="main-tab-content">
                <section class="blog-container">
                    <h2>Blog</h2>
                    <div id="blog-posts-container">
                        <p>Loading blog posts...</p>
                    </div>
                </section>
            </div>

            <div id="tab-testimonials" class="main-tab-content">
                <section class="testimonials-container">
                    <h2>Testimonials</h2>
                    <div class="add-testimonial-toggle">
                        <button id="add-yours-button">Add Your Testimonial</button>
                    </div>
                    <div class="testimonial-submission-form" id="public-testimonial-form-container" style="display:none;">
                        <h3>Share your thoughts!</h3>
                        <p>Your testimonial will be visible after admin approval.</p>
                        <form id="public-testimonial-form">
                            <input type="text" id="public-author-name" placeholder="Your Name" required>
                            <textarea id="public-author-quote" rows="4" placeholder="Your Message" required></textarea>
                            <button type="submit" id="public-submit-button">Submit for Review</button>
                            <button type="button" id="public-cancel-button" class="cancel-button">Cancel</button>
                        </form>
                        <p id="testimonial-thanks" style="display:none; text-align:center; color: green; font-weight: bold;">Thank you! Your testimonial has been submitted.</p>
                    </div>
                    <hr class="section-divider">
                    <!-- NAYA SLIDER YAHAN LOAD HOGA -->
                    <div id="testimonials-list-container">
                        <p>Loading testimonials...</p>
                    </div>
                </section>
            </div>

        </div>
    </div> <footer class="footer">
        <p>Contact: Aaradhya Soni</p>
        <p>Email: warrioraaradhya111@gmail.com</p>
        <p>Whatsapp: +91 9243714402</p>
        <p>&copy; 2025 - All Rights Reserved.</p>
    </footer>

    <script>
        
        // --- FUNCTION 1: Create Video ---
        function createVideo(video_id) {
            const videoWrapper = document.createElement('div');
            videoWrapper.className = 'video-wrapper';
            videoWrapper.innerHTML = `<iframe src="https://www.youtube.com/embed/${video_id}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
            return videoWrapper;
        }
        
        // --- FUNCTION 2: Create Shloka Item (Reverted to ID link) ---
        function createShlokaItem(shloka) {
            const item = document.createElement('div');
            item.className = 'shloka-item-card';
            const shlokaId = `shloka-${shloka.adhyay}-${shloka.shloka}`;
            item.id = shlokaId;
            const formattedText = shloka.text ? shloka.text.replace(/\n/g, '<br>') : '';
            const isLiked = localStorage.getItem('liked_' + shloka._id) === 'true';
            
            // Share link ab 'id' use karega
            const shareUrl = `${window.location.origin}/shloka.html?id=${shloka._id}`;
            const shareTitle = `Aaradhya Soni - Gita Adhyay ${shloka.adhyay}, Shloka ${shloka.shloka}`;
            const shareText = `Listen to Aaradhya's recitation of Gita Adhyay ${shloka.adhyay}, Shloka ${shloka.shloka}`;

            item.innerHTML = `
                <div class="card-video-container">
                    ${createVideo(shloka.video_id).innerHTML}
                </div>
                <div class="card-content">
                    <h3>Adhyay ${shloka.adhyay}, Shloka ${shloka.shloka}</h3>
                    <p class="shloka-text">${formattedText}</p>
                    <div class="shloka-actions">
                        <button class="shloka-action-button like-button" data-id="${shloka._id}" data-type="shloka" ${isLiked ? 'disabled' : ''}>
                            ‚ù§Ô∏è <span class="like-count">${shloka.likes || 0}</span>
                        </button>
                        <button class="shloka-action-button share-button" 
                                data-url="${shareUrl}" 
                                data-title="${shareTitle}" 
                                data-text="${shareText}">
                            üîó Share
                        </button>
                    </div>
                </div>
            `;
            return item;
        }
        
        // --- FUNCTION 3: Load About Section ---
        async function loadAboutSection() {
            const aboutContainer = document.getElementById('about-text-content');
            const aboutImage = document.getElementById('about-image-src');
            try {
                const response = await fetch('/api/about?cache_buster=' + new Date().getTime());
                const data = await response.json();
                if (data && data.content) {
                    aboutContainer.innerHTML = `<p>${data.content.replace(/\n/g, '<br>')}</p>`;
                } else {
                    aboutContainer.innerHTML = '<p>Details could not be loaded.</p>';
                }
                if (data && data.imageUrl && data.imageUrl !== 'placeholder.jpg') {
                    aboutImage.src = data.imageUrl;
                } else {
                    aboutImage.src = 'https://placehold.co/400x400/FFF8E1/BFA080?text=Aaradhya';
                }
            } catch (err) {
                aboutContainer.innerHTML = '<p>Could not load details.</p>';
            }
        }
        
        // --- FUNCTION 4: Load Shlokas (Folding Grid) ---
        async function loadGroupedShlokas() {
            const container = document.getElementById('shloka-container');
            container.innerHTML = ''; 
            try {
                const response = await fetch('/api/shlokas?cache_buster=' + new Date().getTime());
                const shlokas = await response.json(); 
                if (shlokas.length === 0) {
                    container.innerHTML = '<p>No shlokas added yet.</p>';
                    return;
                }
                const shlokasByAdhyay = {};
                shlokas.forEach(shloka => {
                    if (!shlokasByAdhyay[shloka.adhyay]) {
                        shlokasByAdhyay[shloka.adhyay] = [];
                    }
                    shlokasByAdhyay[shloka.adhyay].push(shloka);
                });
                for (const adhyayNum in shlokasByAdhyay) {
                    const adhyayGroup = document.createElement('details');
                    adhyayGroup.className = 'adhyay-group';
                    adhyayGroup.id = `adhyay-${adhyayNum}`;
                    if (parseInt(adhyayNum, 10) === 1) {
                        adhyayGroup.open = true; 
                    }
                    const adhyayTitle = document.createElement('summary');
                    adhyayTitle.className = 'adhyay-title';
                    adhyayTitle.textContent = `Adhyay ${adhyayNum}`;
                    const shlokaGrid = document.createElement('div');
                    shlokaGrid.className = 'shloka-grid';
                    shlokasByAdhyay[adhyayNum].forEach(shloka => {
                        const shlokaElement = createShlokaItem(shloka);
                        shlokaGrid.appendChild(shlokaElement);
                    });
                    adhyayGroup.appendChild(adhyayTitle);
                    adhyayGroup.appendChild(shlokaGrid);
                    container.appendChild(adhyayGroup);
                }
                handleDeepLink(); 
            } catch (err) {
                console.error("Error loading shlokas:", err);
                container.innerHTML = '<p>Could not load shlokas. Please try again later.</p>';
            }
        }

        // --- FUNCTION 5: Load Artwork Gallery (UPDATED) ---
        async function loadArtworkGallery() {
            const container = document.getElementById('gallery-carousel-container'); 
            if (!container) return; 
            try {
                const response = await fetch('/api/artwork?cache_buster=' + new Date().getTime());
                const artworks = await response.json();
                if (artworks.length === 0) {
                    container.innerHTML = '<p style="text-align: center; width: 100%;">No artwork added yet.</p>';
                    return;
                }
                container.innerHTML = ''; 
                
                artworks.forEach((artwork, index) => {
                    const item = document.createElement('div');
                    item.className = 'carousel-item';
                    if (index === 0) item.classList.add('active'); 
                    
                    const isLiked = localStorage.getItem('liked_art_' + artwork._id) === 'true';
                    
                    // [NAYA FIX] Share link ab 'artwork.html?id=...' use karega
                    const shareUrl = `${window.location.origin}/artwork.html?id=${artwork._id}`;
                    const shareTitle = artwork.title + " - by Warrior Aaradhya";
                    
                    item.innerHTML = `
                        <img src="${artwork.imageUrl}" alt="${artwork.title}">
                        <div class="artwork-actions">
                            <button class="shloka-action-button like-button" data-id="${artwork._id}" data-type="artwork" ${isLiked ? 'disabled' : ''}>
                                ‚ù§Ô∏è <span class="like-count">${artwork.likes || 0}</span>
                            </button>
                            <button class="shloka-action-button share-button"
                                    data-url="${shareUrl}" 
                                    data-title="${shareTitle}" 
                                    data-text="Check out this artwork by Warrior Aaradhya:">
                                üîó Share
                            </button>
                        </div>
                    `;
                    container.appendChild(item);
                });
                
                container.innerHTML += `
                    <button class="carousel-button prev" id="carousel-prev">&#10094;</button>
                    <button class="carousel-button next" id="carousel-next">&#10095;</button>
                    <div class="slide-counter" id="slide-counter-text"></div>
                `;
                
                setupCarouselListeners(artworks.length);
            } catch (err) {
                console.error("Error loading artwork:", err);
                container.innerHTML = '<p>Could not load gallery.</p>';
            }
        }

        // --- FUNCTION 6: Carousel logic (AUTOPLAY ADDED) ---
        function setupCarouselListeners(totalSlides) {
            let currentSlide = 0;
            const slides = document.querySelectorAll('#gallery-carousel-container .carousel-item');
            const prevButton = document.getElementById('carousel-prev');
            const nextButton = document.getElementById('carousel-next');
            const counterText = document.getElementById('slide-counter-text');
            
            if (!prevButton || !nextButton || !counterText || slides.length === 0) return; // Guard clause
            
            function showSlide(index) {
                if (index >= totalSlides) { currentSlide = 0; }
                else if (index < 0) { currentSlide = totalSlides - 1; }
                else { currentSlide = index; }
                
                slides.forEach(slide => { slide.classList.remove('active'); });
                slides[currentSlide].classList.add('active');
                counterText.textContent = `${currentSlide + 1} / ${totalSlides}`;
            }
            
            showSlide(0);
            
            prevButton.addEventListener('click', () => { showSlide(currentSlide - 1); });
            nextButton.addEventListener('click', () => { showSlide(currentSlide + 1); });
            
            // [NAYA] AUTOPLAY FOR ARTWORK GALLERY
            setInterval(() => {
                showSlide(currentSlide + 1);
            }, 5000); // Har 5 second mein slide change
        }
        
        // --- FUNCTION 7: Load Blog posts (UPDATED for Grid/Excerpt) ---
        async function loadBlogPosts() {
            const container = document.getElementById('blog-posts-container');
            container.innerHTML = '';
            try {
                const response = await fetch('/api/blog?cache_buster=' + new Date().getTime());
                const posts = await response.json();
                
                if (posts.length === 0) {
                    container.innerHTML = '<p>No blog posts added yet.</p>';
                    return;
                }
                
                // [NAYA] Grid layout ke liye class add karein
                container.classList.add('blog-grid');

                posts.forEach(post => {
                    const item = document.createElement('article');
                    item.className = 'blog-post-item'; // Wahi style reuse hoga
                    item.id = `blog-${post._id}`; 
                    
                    const postDate = new Date(post.createdAt).toLocaleDateString('en-IN', {
                        day: 'numeric', month: 'long', year: 'numeric'
                    });
                    
                    // [NAYA] Post ka chhota preview (excerpt) banayein
                    const excerpt = post.content.substring(0, 100) + "..."; // Pehle 100 characters
                    
                    // [NAYA] Permalink (poora post padhne ka link)
                    const permalink = `blog.html?id=${post._id}`;

                    item.innerHTML = `
                        <h3>${post.title}</h3>
                        <p class="blog-date">${postDate}</p>
                        <div class="blog-content">
                            ${excerpt} </div>
                        <a href="${permalink}" class="read-more-link">Read More...</a>
                    `;
                    // Like/Share buttons yahaan se hata diye gaye hain (taaki list saaf dikhe)
                    // Woh buttons ab 'blog.html' page par hain
                    
                    container.appendChild(item);
                });
            } catch (err) {
                console.error("Error loading blog posts:", err);
                container.innerHTML = '<p>Could not load blog posts.</p>';
            }
        }
        
        // --- [STEP 3] FUNCTION 8: (SWIPER SLIDER MEIN BADAL DIYA GAYA) ---
        async function loadTestimonials() {
            const container = document.getElementById('testimonials-list-container');
            container.innerHTML = '<p>Loading testimonials...</p>'; // Loading message
            try {
                const response = await fetch('/api/testimonials?cache_buster=' + new Date().getTime());
                const testimonials = await response.json();
                
                if (testimonials.length === 0) {
                    container.innerHTML = '<p>No testimonials added yet.</p>';
                    return;
                }
                
                container.innerHTML = ''; // Loading message clear karein

                // 1. Swiper ka main structure banayein
                const swiperContainer = document.createElement('div');
                swiperContainer.className = 'swiper testimonialSwiper';

                const swiperWrapper = document.createElement('div');
                swiperWrapper.className = 'swiper-wrapper';

                // 2. Loop karein aur har testimonial ke liye slide banayein
                testimonials.forEach(testimonial => {
                    const slide = document.createElement('div');
                    slide.className = 'swiper-slide';
                    
                    // Naya card design
                    slide.innerHTML = `
                    <div class="testimonial-card-new">
                      <span class="quote-icon">‚Äú</span>
                      <p class="quote-text">
                        ${testimonial.quote.replace(/\n/g, '<br>')}
                      </p>
                      <div class="author-details">
                        <span class="author-name">- ${testimonial.author}</span>
                      </div>
                    </div>
                    `;
                    swiperWrapper.appendChild(slide);
                });

                // 3. Wrapper ko main container mein daalein
                swiperContainer.appendChild(swiperWrapper);
                
                // 4. Navigation (Arrows) aur Pagination (Dots) add karein
                swiperContainer.innerHTML += `
                    <div class="swiper-button-next"></div>
                    <div class="swiper-button-prev"></div>
                    <div class="swiper-pagination"></div>
                `;
                
                // 5. Poora slider container mein dikhayein
                container.appendChild(swiperContainer);

                // 6. Swiper ko CHALU (Initialize) karein
                // YEH SABSE ZAROORI HAI: new Swiper() ko data load hone ke BAAD call karna
                new Swiper(".testimonialSwiper", {
                    slidesPerView: 1,
                    spaceBetween: 30,
                    loop: true, // Taaki end ke baad wapas start ho
                    
                    autoplay: {
                       delay: 5000, // Har 5 second mein slide
                       disableOnInteraction: false,
                    },

                    // Arrows
                    navigation: {
                        nextEl: ".swiper-button-next",
                        prevEl: ".swiper-button-prev",
                    },
                    
                    // Dots
                    pagination: {
                        el: ".swiper-pagination",
                        clickable: true,
                    },
                });

            } catch (err) {
                console.error("Error loading testimonials:", err);
                container.innerHTML = '<p>Could not load testimonials.</p>';
            }
        }
        
      // --- FUNCTION 9: Deep Link Handler (TABS + FOLDING FIX) ---
function handleDeepLink() {
    const hash = window.location.hash; // Jaise "#tab-testimonials" YA "#shloka-1-1"
    if (!hash) return; // Agar hash nahi hai toh kuch mat karo

    try {
        const targetId = hash.substring(1);
        const targetElement = document.getElementById(targetId);

        if (!targetElement) return; // Agar ID se kuch nahi mila toh chhod do

        let tabToOpenId = '';

        // CASE 1: Link seedha TAB ka hai (jaise #tab-testimonials)
        if (targetElement.classList.contains('main-tab-content')) {
            tabToOpenId = targetId;
        } 
        // CASE 2: Link tab ke ANDAR kisi cheez ka hai (jaise #shloka-1-1)
        else if (targetElement.closest('.main-tab-content')) {
            tabToOpenId = targetElement.closest('.main-tab-content').id;
        }

        // Agar hamein ek valid tab ID mil gayi hai
        if (tabToOpenId) {

            // 1. Saare active class hatao
            document.querySelectorAll('.main-tab-button').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.main-tab-content').forEach(c => c.classList.remove('active'));

            // 2. Sahi button ko active karo
            const buttonToActivate = document.querySelector(`.main-tab-button[data-tab="${tabToOpenId}"]`);
            if (buttonToActivate) {
                buttonToActivate.classList.add('active');
            }

            // 3. Sahi content (div) ko active karo
            const contentToActivate = document.getElementById(tabToOpenId);
            if (contentToActivate) {
                contentToActivate.classList.add('active');
            }

            // 4. Agar link tab ke andar ka tha (CASE 2), toh wahan tak scroll karo
            if (!targetElement.classList.contains('main-tab-content')) {
                // Parent <details> (adhyay) ko dhoondo
                const parentDetails = targetElement.closest('details.adhyay-group');
                if (parentDetails) {
                    parentDetails.open = true; 
                }

                // Element tak scroll karo
                setTimeout(() => { 
                    targetElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    targetElement.classList.add('highlight');
                    setTimeout(() => {
                        targetElement.classList.remove('highlight');
                    }, 2500); 
                }, 100); 
            }
        }
    } catch (e) { console.error("Error handling deep link:", e); }
}

        
        // --- PAGE INITIALIZATION & TAB SWITCHING ---
        document.addEventListener('DOMContentLoaded', () => {
        function switchTabFromHash() {
                const hash = window.location.hash; // Jaise "#tab-testimonials"
                if (!hash) return; // Agar hash nahi hai, toh default (Shlokas) dikhega

                // Hash se 'tab-testimonials' hissa nikalo
                const tabId = hash.substring(1); 
                
                // Check karo ki yeh ek valid MAIN tab ID hai ya nahi
                // (Yeh shloka-1-1 jaise ID ko ignore kar dega)
                const validTabIds = ['tab-shlokas', 'tab-about', 'tab-gallery', 'tab-blog', 'tab-testimonials'];
                
                if (validTabIds.includes(tabId)) {
                    
                    // 1. Saare active class hatao (default 'shlokas' wale)
                    document.querySelectorAll('.main-tab-button').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.main-tab-content').forEach(c => c.classList.remove('active'));
                    
                    // 2. Sahi button ko active karo
                    const buttonToActivate = document.querySelector(`.main-tab-button[data-tab="${tabId}"]`);
                    if (buttonToActivate) {
                        buttonToActivate.classList.add('active');
                    }
                    
                    // 3. Sahi content (div) ko active karo
                    const contentToActivate = document.getElementById(tabId);
                    if (contentToActivate) {
                        contentToActivate.classList.add('active');
                    }
                }
            }
            // Page load hote hi is function ko chalao
            switchTabFromHash();
            const tabButtons = document.querySelectorAll('.main-tab-button');
            const tabContents = document.querySelectorAll('.main-tab-content');
            const menuToggle = document.getElementById('menu-toggle-button');
            const menuLinks = document.getElementById('menu-links-container');

            menuToggle.addEventListener('click', () => {
                menuLinks.classList.toggle('active');
                menuToggle.classList.toggle('active');
            });

           // TAB SWITCHING LOGIC (Ab link par kaam karega)
            tabButtons.forEach(tab => {
                if(tab.tagName === 'BUTTON') {
                    // Agar koi button click karta hai
                    tab.addEventListener('click', () => {
                        // Toh use index.html par bhej do uss hash ke saath
                        const tabId = tab.dataset.tab;
                        window.location.href = `index.html#${tabId}`;
                    });
                }
            });
            

            loadGroupedShlokas(); 
            loadAboutSection(); 
            loadArtworkGallery();
            loadBlogPosts();
            loadTestimonials(); // YEH NAYA SLIDER LOAD KAREGA

            // Public Testimonial Form Handler
            const addButton = document.getElementById('add-yours-button');
            const formContainer = document.getElementById('public-testimonial-form-container');
            const publicForm = document.getElementById('public-testimonial-form');
            const cancelButton = document.getElementById('public-cancel-button');
            const thanksMessage = document.getElementById('testimonial-thanks');
            addButton.addEventListener('click', () => { formContainer.style.display = 'block'; addButton.style.display = 'none'; thanksMessage.style.display = 'none'; });
            cancelButton.addEventListener('click', () => { formContainer.style.display = 'none'; addButton.style.display = 'block'; publicForm.reset(); });
            publicForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const author = document.getElementById('public-author-name').value;
                const quote = document.getElementById('public-author-quote').value;
                if (!author || !quote) { alert('Please fill in both fields.'); return; }
                try {
                    const response = await fetch('/api/testimonials', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ author, quote })
                    });
                    if (response.ok) {
                        publicForm.reset();
                        formContainer.style.display = 'none';
                        thanksMessage.style.display = 'block';
                    } else { alert('Error submitting. Please try again.'); }
                } catch (err) { alert('Error connecting to server.'); }
            });

            // --- NAYA: Universal Share Button Logic ---
            async function handleShareClick(button) {
                const urlToShare = button.dataset.url;
                const title = button.dataset.title;
                const text = button.dataset.text;
                if (navigator.share) {
                    try { await navigator.share({ title: title, text: text, url: urlToShare }); } 
                    catch (err) { console.error('Share failed:', err); }
                } else {
                    try { await navigator.clipboard.writeText(urlToShare); alert('Link copied to clipboard!'); } 
                    catch (err) { alert('Failed to copy link.'); }
                }
            }

            // --- NAYA: Universal Like Button Logic ---
            async function handleLikeClick(button) {
                const id = button.dataset.id;
                const type = button.dataset.type; // 'shloka', 'blog', or 'artwork'
                const key = `liked_${type}_${id}`;
                
                if (localStorage.getItem(key)) { return; }
                
                button.disabled = true;
                try {
                    const response = await fetch(`/api/${type}/like/${id}`, { method: 'POST' });
                    const data = await response.json();
                    if (data.success) {
                        button.querySelector('.like-count').textContent = data.likes;
                        localStorage.setItem(key, 'true');
                    } else {
                        button.disabled = false;
                    }
                } catch (err) {
                    button.disabled = false;
                }
            }
            
            // --- NAYA: Event Listeners for all content tabs ---
            const mainPanels = document.querySelector('.main-tab-panels');
            mainPanels.addEventListener('click', async (e) => {
                
                // Share Button
                const shareButton = e.target.closest('.share-button');
                if (shareButton) {
                    handleShareClick(shareButton);
                }
                
                // Like Button
                const likeButton = e.target.closest('.like-button');
                if (likeButton) {
                    handleLikeClick(likeButton);
                }
            });

        });
    </script>
    
    <!-- [STEP 4] SWIPER SLIDER KI JAVASCRIPT FILE (SABSE AAKHIR MEIN) -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script>
  // Service Worker (PWA) ko register karein
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/sw.js')
        .then(registration => {
          console.log('Service Worker ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§π‡•ã ‡§ó‡§Ø‡§æ:', registration);
        })
        .catch(error => {
          console.log('Service Worker ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§® ‡§´‡§º‡•á‡§≤ ‡§π‡•ã ‡§ó‡§Ø‡§æ:', error);
        });
    });
  }
</script>
<script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then(registration => {
              console.log('Service Worker ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§π‡•ã ‡§ó‡§Ø‡§æ:', registration);
            })
            .catch(error => {
              console.log('Service Worker ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§® ‡§´‡§º‡•á‡§≤ ‡§π‡•ã ‡§ó‡§Ø‡§æ:', error);
            });
        });
      }
    </script>

    <script>
      window.addEventListener('beforeinstallprompt', (e) => {
        // Browser ko automatic prompt dikhane se roko
        console.log('Install prompt roka gaya');
        e.preventDefault();
      });
    </script>
</body>
</html>