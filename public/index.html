<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Meta Tags -->
    <title>Aaradhya Soni | Inspiring Gita Shlokas & Artwork Gallery</title>
    <meta name="description" content="Listen to Aaradhya Soni, an inspiring SMA Type 1 warrior, recite Bhagavad Gita shlokas. Explore her journey and view her beautiful artwork gallery.">
    <meta name="keywords" content="Aaradhya Soni, Gita Shlokas, Bhagavad Gita, SMA Type 1, LearnGeeta, Artwork Gallery, Gita Recitation">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    
    <!-- Header -->
    <header class="hero-section">
        <div class="container">
            <h1>Shrimad Bhagavad Gita</h1>
            <h2>Shloka Recitation by Aaradhya Soni</h2>
            <p class="subtitle">A platform dedicated to Aaradhya's journey of learning the Gita. Listen and share her inspiring efforts.</p>
        </div>
    </header>

    <!-- Tab Structure -->
    <div class="container">
        
        <!-- Tab Buttons -->
        <div class="main-tabs">
            <button class="main-tab-button active" data-tab="tab-shlokas">Home (Shlokas)</button>
            <button class="main-tab-button" data-tab="tab-about">About Aaradhya</button>
            <button class="main-tab-button" data-tab="tab-gallery">Artwork Gallery</button>
        </div>

        <!-- Tab Content Panels -->
        <div class="main-tab-panels">

            <!-- Tab 1: Gita Shlokas (Home) -->
            <div id="tab-shlokas" class="main-tab-content active">
                <main class="shloka-list-container">
                    <h2>Chapters and Shlokas of the Gita</h2>
                    <div id="shloka-container">
                        <p>Loading shlokas...</p>
                    </div>
                </main>
            </div>

            <!-- Tab 2: About Aaradhya -->
            <div id="tab-about" class="main-tab-content">
                <section class="about">
                    <h2>About Aaradhya</h2>
                    <div class="about-content">
                        <div class="about-image">
                            <!-- Placeholder image -->
                            <img src="httpsG://placehold.co/400x400/FFF8E1/BFA080?text=Aaradhya" alt="Aaradhya Soni" id="about-image-src">
                        </div>
                        <div class="about-text" id="about-text-content">
                            <p>Loading details...</p> 
                        </div>
                    </div>
                </section>
            </div>

            <!-- Tab 3: Artwork Gallery (UPDATED TO CAROUSEL) -->
            <div id="tab-gallery" class="main-tab-content">
                <section class="gallery">
                    <h2>Aaradhya's Artwork Gallery</h2>
                    
                    <!-- Naya Carousel Structure -->
                    <div class="carousel-container" id="gallery-carousel-container">
                        <!-- Images JS se load hongi -->
                        <!-- Buttons -->
                        <button classd="carousel-button prev" id="carousel-prev">&#10094;</button>
                        <button class="carousel-button next" id="carousel-next">&#10095;</button>
                        <!-- Slide Number -->
                        <div class="slide-counter" id="slide-counter-text"></div>
                    </div>

                </section>
            </div>

        </div>
    </div> <!-- End container -->


    <footer class="footer">
        <p>Contact: Aaradhya Soni</p>
        <p>Email: warrioraaradhya111@gmail.com</p>
        <p>Whatsapp: +91 9243714402/p>
        <p>&copy; 2025 - All Rights Reserved.</p>
    </footer>

    <!-- Saara Public JavaScript (UPDATED) -->
    <script>
        
        // --- FUNCTION 1, 2, 3, 4 (No Change) ---
        function createVideo(video_id) {
            const videoWrapper = document.createElement('div');
            videoWrapper.className = 'video-wrapper';
            videoWrapper.innerHTML = `
                <iframe 
                    width="560" height="315" 
                    src="https://www.youtube.com/embed/${video_id}" 
                    title="YouTube video player" 
                    frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                    allowfullscreen>
                </iframe>`;
            return videoWrapper;
        }

        function createShlokaItem(shloka) {
            const item = document.createElement('div');
            item.className = 'shloka-item';
            const formattedText = shloka.text ? shloka.text.replace(/\n/g, '<br>') : '';
            item.innerHTML = `
                <h3>Adhyay ${shloka.adhyay}, Shloka ${shloka.shloka}</h3>
                <p class="shloka-text">${formattedText}</p>
            `;
            item.appendChild(createVideo(shloka.video_id));
            return item;
        }

        async function loadAboutSection() {
            const aboutContainer = document.getElementById('about-text-content');
            const aboutImage = document.getElementById('about-image-src');
            try {
                const response = await fetch('/api/about?cache_buster=' + new Date().getTime());
                const data = await response.json();
                
                if (data && data.content) {
                    aboutContainer.innerHTML = `<p>${data.content.replace(/\n/g, '<br>')}</p>`;
                } else {
                    aboutContainer.innerHTML = '<p>Details could not be loaded.</p>';
                }
                
                if (data && data.imageUrl && data.imageUrl !== 'placeholder.jpg') {
                    aboutImage.src = data.imageUrl;
                } else {
                    aboutImage.src = 'https://placehold.co/400x400/FFF8E1/BFA080?text=Aaradhya'; // Fallback
                }
            } catch (err) {
                aboutContainer.innerHTML = '<p>Could not load details.</p>';
            }
        }

        async function loadGroupedShlokas() {
            const container = document.getElementById('shloka-container');
            container.innerHTML = ''; 

            try {
                const response = await fetch('/api/shlokas?cache_buster=' + new Date().getTime());
                const shlokas = await response.json(); 

                if (shlokas.length === 0) {
                    container.innerHTML = '<p>No shlokas added yet.</p>';
                    return;
                }

                const shlokasByAdhyay = {};
                shlokas.forEach(shloka => {
                    if (!shlokasByAdhyay[shloka.adhyay]) {
                        shlokasByAdhyay[shloka.adhyay] = [];
                    }
                    shlokasByAdhyay[shloka.adhyay].push(shloka);
                });

                for (const adhyayNum in shlokasByAdhyay) {
                    const adhyayGroup = document.createElement('details');
					adhyayGroup.className = 'adhyay-group';
					
					const numAdhyay = parseInt(adhyayNum, 10);
					if (numAdhyay <= 3) {
						adhyayGroup.open = true; 
					}

                    const adhyayTitle = document.createElement('summary');
                    adhyayTitle.className = 'adhyay-title';
                    adhyayTitle.textContent = `Adhyay ${adhyayNum}`;
                    adhyayGroup.appendChild(adhyayTitle);

                    shlokasByAdhyay[adhyayNum].forEach(shloka => {
                        const shlokaElement = createShlokaItem(shloka);
                        adhyayGroup.appendChild(shlokaElement);
                    });

                    container.appendChild(adhyayGroup);
                }
            } catch (err) {
                console.error("Error loading shlokas:", err);
                container.innerHTML = '<p>Could not load shlokas. Please try again later.</p>';
            }
        }

        // --- FUNCTION 5: Artwork Gallery load karna (UPDATED FOR CAROUSEL) ---
        async function loadArtworkGallery() {
            const container = document.getElementById('gallery-carousel-container'); 
            if (!container) return; 
            
            try {
                const response = await fetch('/api/artwork?cache_buster=' + new Date().getTime());
                const artworks = await response.json();

                if (artworks.length === 0) {
                    container.innerHTML = '<p style="text-align: center; width: 100%;">No artwork added yet.</p>';
                    return;
                }
                
                // Naya Carousel Logic
                artworks.forEach((artwork, index) => {
                    const item = document.createElement('div');
                    item.className = 'carousel-item';
                    // Pehli image ko 'active' (visible) banao
                    if (index === 0) item.classList.add('active'); 
                    item.innerHTML = `<img src="${artwork.imageUrl}" alt="${artwork.title}">`;
                    container.appendChild(item);
                });
                
                // Naya Function call: Carousel ke button set karo
                setupCarouselListeners(artworks.length);

            } catch (err) {
                console.error("Error loading artwork:", err);
                container.innerHTML = '<p>Could not load gallery.</p>';
            }
        }

        // --- NAYA FUNCTION 6: Carousel button logic ---
        function setupCarouselListeners(totalSlides) {
            let currentSlide = 0;
            const slides = document.querySelectorAll('#gallery-carousel-container .carousel-item');
            const prevButton = document.getElementById('carousel-prev');
            const nextButton = document.getElementById('carousel-next');
            const counterText = document.getElementById('slide-counter-text');

            function showSlide(index) {
                // Bounds check karo (aakhiri slide se aage/peeche jaana)
                if (index >= totalSlides) {
                    currentSlide = 0; // Waapas pehli slide par
                } else if (index < 0) {
                    currentSlide = totalSlides - 1; // Aakhiri slide par
                } else {
                    currentSlide = index;
                }

                // Sabhi slides ko chhipao
                slides.forEach(slide => {
                    slide.classList.remove('active');
                });
                
                // Sirf current slide ko dikhao
                slides[currentSlide].classList.add('active');
                
                // Counter update karo
                counterText.textContent = `${currentSlide + 1} / ${totalSlides}`;
            }

            // Pehli slide dikhao
            showSlide(0);

            // Button clicks
            prevButton.addEventListener('click', () => {
                showSlide(currentSlide - 1);
            });

            nextButton.addEventListener('click', () => {
                showSlide(currentSlide + 1);
            });
        }
        
        
        // --- TAB SWITCHING JAVASCRIPT ---
        document.addEventListener('DOMContentLoaded', () => {
            const tabs = document.querySelectorAll('.main-tab-button');
            const contents = document.querySelectorAll('.main-tab-content');

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    contents.forEach(c => c.classList.remove('active'));

                    tab.classList.add('active');
                    document.getElementById(tab.dataset.tab).classList.add('active');
                });
            });

            // Page load par sabhi data load karein
            loadGroupedShlokas(); 
            loadAboutSection(); 
            loadArtworkGallery(); 
        });
    </script>
</body>
</html>