<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aaradhya Soni - Geeta Shlokas</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    
    <header class="hero-section">
        </header>

    <section class="about">
        <div class="container">
            <h2>About Aaradhya</h2>
            <div class="about-content">
                <div class="about-image">
                    <img src="placeholder.jpg" alt="Aaradhya Soni" id="about-image-src">
                </div>
                <div class="about-text" id="about-text-content">
                    <p>Loading details...</p> 
                </div>
            </div>
        </div>
    </section>

    <section class="gallery">
        <div class="container">
            <h2>Aaradhya's Artwork Gallery</h2>
            <div class="gallery-grid" id="gallery-grid-container">
                <p>Gallery loading...</p>
                </div>
        </div>
    </section>

    <main class="shloka-list-container">
        <div class="container">
            <h2>Chapters and Shlokas of the Gita</h2>
            <div id="shloka-container">
                <p>Loading shlokas...</p>
            </div>
        </div>
    </main>

    <footer class="footer">
        </footer>

    <script>
        
        // (createVideo aur createShlokaItem functions - No Change)
        function createVideo(video_id) { /* ... (Pehle jaisa) ... */ }
        function createShlokaItem(shloka) { /* ... (Pehle jaisa) ... */ }

        // 'About' section load function (No Change)
        async function loadAboutSection() { /* ... (Pehle jaisa) ... */ }


        // --- NAYA: Shlokas ko Group aur Render karne ka Logic ---
        async function loadGroupedShlokas() {
            const container = document.getElementById('shloka-container');
            container.innerHTML = ''; // "Loading..." hatao

            try {
                const response = await fetch('/api/shlokas');
                const shlokas = await response.json(); // Sorted list mili

                if (shlokas.length === 0) {
                    container.innerHTML = '<p>No shlokas added yet.</p>';
                    return;
                }

                // Step 1: Shlokas ko Adhyay se group karo
                const shlokasByAdhyay = {};
                shlokas.forEach(shloka => {
                    if (!shlokasByAdhyay[shloka.adhyay]) {
                        shlokasByAdhyay[shloka.adhyay] = []; // Nayi list banao
                    }
                    shlokasByAdhyay[shloka.adhyay].push(shloka);
                });

                // Step 2: Grouped list ko render karo
                for (const adhyayNum in shlokasByAdhyay) {
                    // 1. Naya <details> element banao group ke liye
                    const adhyayGroup = document.createElement('details');
                    adhyayGroup.className = 'adhyay-group';
                    if (adhyayNum == 1) {
                        adhyayGroup.open = true; // Pehla adhyay khula rakho
                    }

                    // 2. Title banao
                    const adhyayTitle = document.createElement('summary');
                    adhyayTitle.className = 'adhyay-title';
                    adhyayTitle.textContent = `Adhyay ${adhyayNum}`;
                    adhyayGroup.appendChild(adhyayTitle);

                    // 3. Is adhyay ke saare shlokas loop karke add karo
                    shlokasByAdhyay[adhyayNum].forEach(shloka => {
                        const shlokaElement = createShlokaItem(shloka);
                        adhyayGroup.appendChild(shlokaElement);
                    });

                    // 4. Poore group ko container mein add karo
                    container.appendChild(adhyayGroup);
                }
            } catch (err) {
                container.innerHTML = '<p>Could not load shlokas. Please try again later.</p>';
            }
        }

        // NAYA: Artwork Gallery load karne ka function
        async function loadArtworkGallery() {
            const container = document.getElementById('gallery-grid-container');
            container.innerHTML = ''; // "Loading..." hatao
            try {
                const response = await fetch('/api/artwork');
                const artworks = await response.json();

                if (artworks.length === 0) {
                    container.innerHTML = '<p>No artwork added yet.</p>';
                    return;
                }

                artworks.forEach(artwork => {
                    const item = document.createElement('div');
                    item.className = 'gallery-item';
                    item.innerHTML = `<img src="${artwork.imageUrl}" alt="${artwork.title}">`;
                    container.appendChild(item);
                });
            } catch (err) {
                container.innerHTML = '<p>Could not load gallery.</p>';
            }
        }

        // Page load hone par sab kuch load karein (UPDATED)
        window.addEventListener('load', () => {
            loadGroupedShlokas(); // Naya grouped function call karo
            loadAboutSection(); 
            loadArtworkGallery(); // Naya gallery function call karo
        });
    </script>
</body>
</html>