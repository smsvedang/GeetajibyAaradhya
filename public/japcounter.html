<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jap Counter - Warrior Aaradhya</title>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="style.css">
    
    <style>
        /* Is page ke specific styles jo body par lagne zaroori hain */
    
    </style>
</head>
<body>

    <nav class="top-navbar">
        <div class="container nav-container">
            <div class="logo">
                <a href="index.html" style="text-decoration: none; color: #D84315;">Warrior Aaradhya</a>
            </div>
            <div class="shloka-nav-links">
                <a href="index.html" class="home-button">Home</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <h1 class="page-title">Jap Counter</h1>
        <div class="counter-container" id="mainCounter">
            
            <div class="belt belt-top"></div>
            
            <div class="finger-counter">
                <div class="screen" id="display">00000</div>
                <button class="count-button" id="incrementButton"></button>
                
                <div class="button-row">
                    <button class="small-button" id="resetButton">RESET</button>
                    <button class="small-button" id="recordsButton">RECORDS</button>
                </div>
            </div>
            
            <div class="belt belt-bottom"></div>
        </div>
    </div>

    <div id="recordsModal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeModal">&times;</span>
            <h2>Previous Records</h2>
            <ul id="recordsList">
                </ul>
        </div>
    </div>

    <div id="confirmModal" class="confirm-modal">
        <div class="confirm-content">
            <p id="confirmText">Are you sure you want to delete this record?</p>
            <div class="confirm-buttons">
                <button id="confirmCancel">Cancel</button>
                <button id="confirmYes">Yes, Delete</button>
            </div>
        </div>
    </div>

    <script type="module">
        // --- 1. DOM एलिमेंट्स ---
        const displayElement = document.getElementById('display');
        const incrementButton = document.getElementById('incrementButton');
        const resetButton = document.getElementById('resetButton');
        // ... (Baaki saare elements) ...
        const recordsButton = document.getElementById('recordsButton');
        const modal = document.getElementById('recordsModal');
        const closeModal = document.getElementById('closeModal');
        const recordsList = document.getElementById('recordsList');
        const confirmModal = document.getElementById('confirmModal');
        const confirmYes = document.getElementById('confirmYes');
        const confirmCancel = document.getElementById('confirmCancel');
        const confirmText = document.getElementById('confirmText');
        
        // --- 2. ग्लोबल वेरिएबल्स ---
        let count = 0;
        let todayDate = getTodayDateString();
        const STORAGE_KEY = 'japCounterRecords'; 
        let dateToDelete = null; 

        // --- 3. साउंड और वाइब्रेशन ---
        let audioCtx = null;
        function playClickSound() {
            if (audioCtx === null) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.type = 'triangle';
            oscillator.frequency.setValueAtTime(800, audioCtx.currentTime);
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.05);
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.05);
        }
        function playResetSound() {
            if (audioCtx === null) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioCtx.createOscillator();
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(440, audioCtx.currentTime);
            oscillator.connect(audioCtx.destination);
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.1);
        }
        function triggerVibration(duration) {
            if ("vibrate" in navigator) navigator.vibrate(duration);
        }

        // --- 4. हेल्पर फंक्शन्स ---
        function getTodayDateString() {
            const today = new Date();
            const yyyy = today.getFullYear();
            const mm = String(today.getMonth() + 1).padStart(2, '0');
            const dd = String(today.getDate()).padStart(2, '0');
            return `${yyyy}-${mm}-${dd}`;
        }
        function updateDisplay() {
            displayElement.textContent = String(count).padStart(5, '0');
        }

        // --- 5. LocalStorage लॉजिक ---
        function getRecords() {
            const recordsJSON = localStorage.getItem(STORAGE_KEY);
            return recordsJSON ? JSON.parse(recordsJSON) : [];
        }
        function saveRecords(records) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(records));
        }
        function loadTodaysCount() {
            todayDate = getTodayDateString();
            const records = getRecords();
            const todayRecord = records.find(record => record.date === todayDate);
            if (todayRecord) {
                count = todayRecord.count;
            } else {
                count = 0;
            }
            updateDisplay();
        }
        function saveCurrentCount() {
            todayDate = getTodayDateString();
            let records = getRecords();
            const todayIndex = records.findIndex(record => record.date === todayDate);
            if (todayIndex > -1) {
                records[todayIndex].count = count;
            } else {
                records.push({ date: todayDate, count: count });
            }
            saveRecords(records);
        }
        function checkDayChange() {
            const newDate = getTodayDateString();
            if (newDate !== todayDate) {
                todayDate = newDate;
                count = 0; 
                updateDisplay();
            }
        }
        function populateRecordsModal() {
            recordsList.innerHTML = ''; 
            let records = getRecords();
            records.sort((a, b) => b.date.localeCompare(a.date));
            if (records.length === 0) {
                recordsList.innerHTML = '<li>No previous records found.</li>';
                return;
            }
            records.forEach(record => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <span class="record-info">
                        <span class="date">${record.date}</span>
                        <span class="count">${record.count}</span>
                    </span>
                    <button class="delete-button" data-date="${record.date}">DELETE</button>
                `;
                recordsList.appendChild(li);
            });
        }

        // --- 6. इवेंट लिस्नर्स ---
        incrementButton.addEventListener('click', () => {
            checkDayChange();
            count++;
            if (count > 99999) {
                count = 0;
            }
            updateDisplay();
            saveCurrentCount();
            playClickSound();
            triggerVibration(50);
        });
        resetButton.addEventListener('click', () => {
            checkDayChange();
            count = 0;
            updateDisplay();
            saveCurrentCount(); 
            playResetSound();
            triggerVibration([80, 50, 80]);
        });
        recordsButton.addEventListener('click', () => {
            populateRecordsModal();
            modal.style.display = 'block';
        });
        closeModal.onclick = () => {
            modal.style.display = "none";
        }
        window.onclick = (event) => {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }
        recordsList.addEventListener('click', (event) => {
            if (event.target.classList.contains('delete-button')) {
                dateToDelete = event.target.getAttribute('data-date');
                confirmText.textContent = `Are you sure you want to delete the record for ${dateToDelete}?`;
                confirmModal.style.display = 'flex';
            }
        });
        confirmYes.addEventListener('click', () => {
            if (dateToDelete) {
                let records = getRecords();
                let newRecords = records.filter(record => record.date !== dateToDelete);
                saveRecords(newRecords);
                populateRecordsModal();
                if (dateToDelete === todayDate) {
                    count = 0;
                    updateDisplay();
                }
            }
            confirmModal.style.display = 'none';
            dateToDelete = null;
        });
        confirmCancel.addEventListener('click', () => {
            confirmModal.style.display = 'none';
            dateToDelete = null;
        });

        // --- 7. ऐप शुरू करें ---
        loadTodaysCount();
    </script>

</body>
</html>